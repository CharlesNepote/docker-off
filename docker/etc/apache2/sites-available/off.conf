# http://httpd.apache.org/docs/current/en/mod/core.html
# https://perl.apache.org/docs/2.0/user/handlers/http.html
# https://perl.apache.org/docs/2.0/user/config/config.html
# https://github.com/h5bp/server-configs-apache/blob/master/dist/.htaccess

# Equal to `use warnings;` in all files.
PerlWarn On
# Load every modules in memory.
PerlRequire ${PERL5LIB}/startup_apache2.pl
# Hot reload.
PerlModule Apache2::Reload
PerlInitHandler Apache2::Reload
PerlSetVar ReloadDirectories ${PERL5LIB}

<Location /cgi>
  SetHandler perl-script
  Options ExecCGI
  Require all granted
  PerlResponseHandler ModPerl::Registry
  PerlOptions +ParseHeaders
</Location>

<VirtualHost *:${OFF_APACHE_PORT}>
  DocumentRoot ${OFF_DOCUMENT_ROOT}
  ServerName ${OFF_SERVER_NAME}
  ServerAdmin ${OFF_SERVER_ADMIN}
  ScriptAlias /cgi ${OFF_ROOT}/cgi
  LogFormat "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" proxy
  CustomLog ${OFF_ROOT}/logs/apache.access.log combined
  ErrorLog ${OFF_ROOT}/logs/apache.error.log

  <Directory ${OFF_DOCUMENT_ROOT}>
    Require all granted
  </Directory>
</VirtualHost>
